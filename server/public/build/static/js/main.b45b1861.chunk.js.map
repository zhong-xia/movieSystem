{"version":3,"sources":["assets/暂无图片.png","services/CommonTypes.ts","pages/Home.tsx","components/MovieTable.tsx","services/MovieService.ts","redux/actions/MovieAction.ts","pages/movie/MovieList.tsx","components/ImgUploader.tsx","components/MovieForm.tsx","pages/movie/AddMovie.tsx","pages/movie/EditMovie.tsx","pages/Layout.tsx","redux/reducers/MovieReducer.ts","redux/reducers/RootReducer.ts","redux/store.ts","App.tsx","index.tsx"],"names":["module","exports","SwitchType","React","Component","this","props","onLoad","p","style","padding","width","marginBottom","display","value","condition","key","onChange","e","onKeyChange","target","onPressEnter","onSearch","type","icon","size","marginRight","onClick","title","dataIndex","render","poster","alt","className","src","defaultposterImg","filterDropdown","getFilterDropDown","bind","filterIcon","text","join","timeLong","isHot","record","checked","newVal","onSwitchChange","_id","isComing","isClassic","id","to","onConfirm","a","async","onDelete","message","success","okText","cancelText","total","current","page","pageSize","limit","pagination","rowKey","dataSource","data","columns","getColumns","getPageConfig","handleChange","loading","isLoading","MovieService","movie","axios","post","put","delete","get","Promise","resolve","setTimeout","params","saveMoviesAction","movies","payload","setLoadingAction","SetConditionAction","deleteAction","changeSwitchAction","fetchMovies","dispatch","getState","curCondition","getMovies","resp","deleteMovie","changeSwitch","edit","connect","state","MovieAction","newState","newPage","MovieTable","showModal","uid","name","url","formData","FormData","append","filename","file","request","Request","action","method","body","fetch","then","json","err","error","accept","listType","fileList","getFileList","customRequest","handleRequest","onRemove","onPreview","setState","getUploadContent","visible","footer","onCancel","formItemLayout","labelCol","span","wrapperCol","offset","AllAreas","label","AreaGroups","Checkbox","Group","AllTypes","TypeGroups","MovieForm","preventDefault","form","validateFields","errors","getFieldsValue","onSubmit","result","history","push","getFieldDecorator","handleSubmit","Item","rules","required","options","min","step","initialValue","valuePropName","TextArea","htmlType","withRouter","Form","create","mapPropsToFields","obj","createFormField","getDefaultField","add","undefined","getMovieById","match","Header","Layout","Sider","Content","_Layout","mode","theme","path","component","Home","exact","MovieList","AddMovie","EditMovie","defaultState","totalPage","saveMovie","Math","ceil","setCondition","setLoading","filter","m","find","d","newMovie","newData","map","rootReducer","combineReducers","store","createStore","applyMiddleware","thunk","logger","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.b45b1861.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAGsklEQVR4Xu1ba4wURRCu6t0T9X5ARExUolFBolES3+8IKD9MfIQESASjnkZ+8ANzZLs6d2rkjIRMDy4aH4kQuPMRTfAHGqNoREQDghJJlAAxhPOPisL5+OH5yM10mVpnzrm9PW52b+Dulu1kso+p7q7v66rq7poehJO84EmOHxoENCygjAHP8xYj4hwAmBFdZ9YBSfsAYD8idjvnXjDGfB9jGuACnuetQMQn6wDwsSD0AMBSInpLhPoJsNZynQMvh9dCRF0lAqy17wDA3ScZAZDP56ejtfYhAFifBM/M65m5yzn3bXt7+9HxTozv+zOZ+XEAWJDEgoibhYCXAWBJ4sY2Ipo93kFX0r9SjBMCPgGAWYkKNxPRjnokIHL3jwDg9v5ZwPO8I4g4Jf5DKTWlUChIpKzLUm7xYgEDoj8R1fXqsNwNGgQ0LKDhArXHAN/3ZfZ4SGt9fxRhCRF/cc6dppSaqLVeuWrVquQMMyiwtrW1bRtuFRrHJZmxklN0+e80UTuzGOD7/pPMvCIMw9m5XE4C6YMAcA0irmXmbqVU9+TJk7t7enqMKMbMZwPAdYj4dlJRrXWHECAgPc+bqpRaprWmWMb3/R1a65sigssJ+IaIZqYBHstkRoCMbD6fvzUC16uUOuqc60LEFXFnAi6pXAy0XGH5n5nnIOLW5D2l1K1hGD5rjLkyJgAAXkrIrAOAR+R3GIZHxZqGIyMzAqy1JfCIuISZ1zrnepRSi4joMVlbGGPOEisRGefc30qpX0UuSZDciy0AAF4EgE8BYGME4gkietpau5+ILk0QEC/NA2b+UynVK59hGH54QgkQCxDTjwkAgJVNTU0LWltbD8e+mfT/XC53ISLOYubXAeCfMAxL6404BjDzfUopWZK/ysx3AcAVALAJAO4hogsiAr6Lvw830kPdz8wCpIOIBFlKl5dB+wlr7T9ENMFau5OIbpAKnZ2dp7a0tPwtLtDb2zuhubn5fKXU3DAMb0PEL4jIWmsPE5HED9m1Sqx5AgCC6OoDgINE9H5aQjIlwFp7LwC8MRwB4grOuTOMMY+WAdqIiE8x897IkhYx8x5EPAAAB/L5/IEgCLqJaFKxWJwWBME+ITER0Awi7h1VAph5hjGmP/BFI7WJiOZF3zcz88/GGJklZBT7zVhG1Dk3SSn1OwDMZ+a+XC7XJ58AIGZ/hJk3Cmjf92WUv0gG1mgm2j2qBCDixcx8CiKe7pxrRsRmADhH5mvf95cBwNTktBblHCUOSED8QGu9KdqRDpV3mIKI7czcSkQLk9YWWdbnxhjZ4aUqmbpAqh7HmFCDgLLEb2M32NgNNnaDte8Gk/HNWisZV7lkabrVGPPaGIt/JXWOSxCslG1l5huMMbvGGgmZE7B69er5zrnSY6by0tvbm+vo6HBjiYRMCfA87xJE3H8MgIeIaNrxIqBYLJ4bBEFIRD+l7SNTAobL5ERKdRFRS1oF08hZayVBIkmT+HHem0S0KE3dzAiw1v4gS940nQLAw0S0IaXsMcWiYBvnDPplJc9QnoCp1FAmBFhrPwYAOUNQTbmKiPZUU6FcdijwsRwiLtZaV9qd9jc1YgJ833+OmWWTU3XJ5/OnL1++/K+qK/63i5QpdtDIl7X1i1LqjkKhsHuoPkZEgOd5SxBRHqbWWr4kouuqrZwSfKlZZt5FRDciYsXzDjUTEAWe7dUqX0H+GSIqpG2nGvCJNl8logcyiwFr1qyZ1NfX91tapVPIpQqKNYKPuy8lVct1qckCrLWSsZmYAlhqEUS8UWu9c6gKIwRfalYpNa9QKAx4DlE1AZLEBIDrUyNLKYiIfwRBcF5bW9sgy8oCfKSGPPq/XGt9JFarKgJ839/AzJkuYsr42UJEc5P/ZQi+1Cwibtda31I1AZ7naUS0KQd0JGLPE1FpWs0afKwUInZqreUsVLrdoLX2TgB4dySoqqy7FADkVMpw83yVzf4vLml3rfW6YV0gDMOLcrncoZp7GsMVnXOXIeKC5GHQQTlBAJCcfNMYxjES1X5k5nXDETCSDsZD3YMAML0/PqTc0o4HYDXpWMkFampovFZqENBwAWu/BoCqztmMV3OvpLe4gDypXVxPoKrBIiezToa3RIbipLt0TsfzvIOIeNzS19WMyAmWXRgTIGdytpzgzke1O2Z+zxhzZ/KdoTRJx1FVOqvOmfkrY8zV0t6Ao/HFYvG0IAhWRg85p2bV4VhpBxE/d869YoxZ278UHkq56D2ba5l53BOhlPosn8/vaW1tldTegFLXL0eksbwGAWlYqmeZfwG1lb83uv1+hQAAAABJRU5ErkJggg==\"","export interface IResponseError {\r\n    err: string\r\n    data: null\r\n}\r\n\r\nexport interface IResponseData<T> {\r\n    err: \"\"\r\n    data: T\r\n}\r\n\r\nexport interface IResponsePageData<T> {\r\n    err: \"\"\r\n    total: number\r\n    data: T[]\r\n}\r\n\r\nexport interface ISearchCondition {\r\n    page?: number\r\n    limit?: number\r\n    key?: string\r\n}\r\n\r\nexport enum SwitchType {\r\n    isHot = \"isHot\",\r\n    isComing = \"isComing\",\r\n    isClassic = \"isClassic\"\r\n}\r\n","import React from \"react\";\r\n// import ImgUploader from \"../components/ImgUploader\";\r\n\r\nexport default class extends React.Component {\r\n\r\n    // state = {\r\n    //     img: \"\"\r\n    // }\r\n    render() {\r\n        return (\r\n            <h1>\r\n                欢迎使用电影管理系统\r\n            </h1>\r\n            // <ImgUploader value={this.state.img}\r\n            //         onChange={newurl => {\r\n            //             this.setState({\r\n            //                 img: newurl\r\n            //             })\r\n            //         }}/>\r\n        )\r\n    }\r\n}","import React from \"react\";\r\nimport { IMovieState } from \"../redux/reducers/MovieReducer\";\r\nimport { Table, Switch, Button, message, Popconfirm, Icon, Input } from \"antd\";\r\nimport { ColumnProps, PaginationConfig } from \"antd/lib/table\";\r\nimport { IMovie } from \"../services/MovieService\";\r\nimport defaultposterImg from \"../assets/暂无图片.png\";\r\nimport { SwitchType } from \"../services/CommonTypes\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { async } from \"q\";\r\n\r\nexport interface IMovieTableEvents {\r\n    /**\r\n     * 完成加载之后的事件\r\n     */\r\n    onLoad: () => void\r\n    onSwitchChange: (type: SwitchType, newState: boolean, id: string) => void\r\n    onDelete: (id: string) => Promise<void>\r\n    onChange:(newPage: number) => void\r\n    onKeyChange: (key: string) => void\r\n    onSearch: () => void\r\n}\r\n\r\nexport default class extends React.Component<IMovieState & IMovieTableEvents> {\r\n    componentDidMount(){\r\n        // console.log(this.props)\r\n        if(this.props.onLoad) {\r\n            this.props.onLoad()\r\n        }\r\n\r\n    }\r\n\r\n    // private handleSearch() {\r\n    //     this.props.onSearch();\r\n    // }\r\n\r\n    private getFilterDropDown(p: Object){\r\n        return (\r\n            <div style={{ padding: 8 }}>\r\n            <Input\r\n              style={{ width: 188, marginBottom: 8, display: 'block' }}\r\n              value={this.props.condition.key}\r\n              onChange={e => this.props.onKeyChange(e.target.value)}\r\n              onPressEnter={this.props.onSearch}\r\n            />\r\n            <Button\r\n              type=\"primary\"\r\n              icon=\"search\"\r\n              size=\"small\"\r\n              style={{ width: 90, marginRight: 8 }}\r\n              onClick={this.props.onSearch}\r\n            >\r\n             搜索\r\n            </Button>\r\n            <Button  size=\"small\" style={{ width: 90 }}\r\n            onClick={()=>{\r\n                this.props.onKeyChange(\"\")\r\n                this.props.onSearch();\r\n            }}>\r\n              重置\r\n            </Button>\r\n          </div>\r\n        )\r\n    }\r\n\r\n    private getColumns(): ColumnProps<IMovie>[] {\r\n        return [\r\n            {\r\n                title: \"封面\",\r\n                dataIndex: \"poster\",\r\n                render: poster => {\r\n                    if(poster){\r\n                        return <img alt=\"\" className=\"tablePoster\" src={poster}/>\r\n                    }\r\n                    else{\r\n                        return <img alt=\"\" className=\"tablePoster\" src={defaultposterImg}/>\r\n                    }\r\n                }\r\n            },\r\n            { title: \"名称\", dataIndex:\"name\",\r\n                filterDropdown: this.getFilterDropDown.bind(this),\r\n                filterIcon: <Icon type=\"search\"/>\r\n                // p => {\r\n                //     console.log(p);\r\n                //     return (\r\n                //         <h1>搜索</h1>\r\n                //     )\r\n                // }\r\n            },\r\n            { \r\n                title: \"地区\",\r\n                dataIndex:\"areas\",\r\n                render: (text: string[]) => {\r\n                    // console.log(text);\r\n                    // console.log(record)\r\n                    return text.join(\", \")\r\n                }\r\n             },\r\n                { \r\n                    title: \"类型\",\r\n                    dataIndex:\"types\",\r\n                    render: (text: string[]) => {\r\n                        // console.log(text);\r\n                        // console.log(record)\r\n                        return text.join(\", \")\r\n                    }\r\n                },\r\n                {\r\n                    title:\"时长\",\r\n                    dataIndex:\"timeLong\",\r\n                    render(timeLong) {\r\n                        return timeLong + \"分钟\";\r\n                    }\r\n                },\r\n                {\r\n                    title:\"正在热映\",\r\n                    dataIndex:\"isHot\",\r\n                    render:(isHot, record) => {\r\n                        return <Switch checked={isHot} onChange={(newVal) => {\r\n                            // ! 的意思就是去掉undefined，之前是?=是可选的，然后!就代表不可选\r\n                            this.props.onSwitchChange(SwitchType.isHot, newVal, record._id!)\r\n                        }}/>\r\n                    }\r\n                },\r\n                {\r\n                    title:\"即将上映\",\r\n                    dataIndex:\"isComing\",\r\n                    render:(isHot, record) => {\r\n                        return <Switch checked={isHot} onChange={(newVal) => {\r\n                            // ! 的意思就是去掉undefined，之前是?=是可选的，然后!就代表不可选\r\n                            this.props.onSwitchChange(SwitchType.isComing, newVal, record._id!)\r\n                        }}/>\r\n                    }\r\n                },\r\n                {\r\n                    title:\"经典影片\",\r\n                    dataIndex:\"isClassic\",\r\n                    render:(isHot, record) => {\r\n                        return <Switch checked={isHot} onChange={(newVal) => {\r\n                            // ! 的意思就是去掉undefined，之前是?=是可选的，然后!就代表不可选\r\n                            this.props.onSwitchChange(SwitchType.isClassic, newVal, record._id!)\r\n                        }}/>\r\n                    }\r\n                },\r\n                {\r\n                    title:\"操作\",\r\n                    dataIndex: \"_id\",\r\n                    render:(id: string) => {\r\n                        return (\r\n                            <div>\r\n                                <NavLink to={\"/movie/edit/\" + id}>\r\n                                    <Button type=\"primary\" size=\"small\">编辑</Button>\r\n                                </NavLink>  \r\n                                <Popconfirm title=\"确定要删除吗？\" onConfirm={async() => {\r\n                                     await this.props.onDelete(id);\r\n                                     message.success('删除成功');\r\n                                }} okText=\"确定\" cancelText=\"取消\">\r\n                                    <Button type=\"danger\" size=\"small\">删除</Button>\r\n                                </Popconfirm>                        \r\n                               \r\n                            </div>\r\n                        );\r\n                    }\r\n                }\r\n        ]\r\n    }\r\n\r\n    getPageConfig(): PaginationConfig | false {\r\n        if(this.props.total === 0) {\r\n            return false;\r\n        }\r\n        return {\r\n            current: this.props.condition.page,\r\n            pageSize: this.props.condition.limit,\r\n            total: this.props.total\r\n        }\r\n    }\r\n\r\n    handleChange(pagination: PaginationConfig){\r\n        // console.log(pagination)\r\n        this.props.onChange(pagination.current!);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            // <h1>\r\n            //     电影的表格组件\r\n            // </h1>\r\n            <Table rowKey=\"_id\" dataSource={this.props.data} \r\n            columns={this.getColumns()}\r\n            pagination={this.getPageConfig()}\r\n            onChange={this.handleChange.bind(this)}\r\n            loading={this.props.isLoading}\r\n            ></Table>\r\n        );\r\n    }\r\n}","import axios from \"axios\";\r\nimport { IResponseData, IResponseError, ISearchCondition, IResponsePageData } from \"./CommonTypes\";\r\n\r\nexport interface IMovie {\r\n    _id?: string\r\n    name: string\r\n    types: string[]\r\n    areas: string[]\r\n    timeLong: number\r\n    isHot: boolean \r\n    isComing: boolean \r\n    isClassic: boolean \r\n    description?: string\r\n    poster?: string\r\n}\r\n\r\n\r\nexport class MovieService {\r\n    // static edit(id: string, arg1: { isHot: boolean; }) {\r\n    //     throw new Error(\"Method not implemented.\");\r\n    // }\r\n\r\n    // 添加\r\n    public static async add(movie:IMovie): Promise<IResponseData<IMovie> | IResponseError> {\r\n        const { data } = await axios.post(\"/api/movie\", movie)\r\n        return data;\r\n    }\r\n\r\n    public static async edit(id: string, movie:Partial<IMovie>): Promise<IResponseData<true> | IResponseError> {\r\n        const { data } = await axios.put(\"/api/movie/\" + id, movie);\r\n        return data;\r\n    }\r\n\r\n    public static async delete(id: string): Promise<IResponseData<true> | IResponseError> {\r\n        const { data } = await axios.delete(\"/api/movie/\" + id);\r\n        return data;\r\n    }\r\n\r\n    public static async getMovieById(id: string): Promise<IResponseData<IMovie | null>> {\r\n        const { data } = await axios.get(\"/api/movie/\" + id);\r\n        return data;\r\n    }\r\n\r\n    public static async getMovies(condition: ISearchCondition): Promise<IResponsePageData<IMovie>> {\r\n       return new Promise(resolve => {\r\n           setTimeout(async () => {\r\n            const { data } = await axios.get(\"/api/movie\", {\r\n                params: condition\r\n            });\r\n            resolve(data)\r\n           },1000);\r\n       })\r\n       \r\n       \r\n    }\r\n}","// action的创建函数\r\n\r\n\r\nimport { IMovie, MovieService } from \"../../services/MovieService\";\r\nimport { IAction } from \"./ActionTypes\";\r\nimport { ISearchCondition, SwitchType } from \"../../services/CommonTypes\";\r\nimport { ThunkAction, ThunkDispatch } from \"redux-thunk\";\r\nimport { IRootState } from \"../reducers/RootReducer\";\r\n// let a: Action\r\n\r\nexport type SaveMoviesAction = IAction<\"movie_save\", {\r\n    movies: IMovie[]\r\n    total: number\r\n}>;\r\n\r\n// 上面的代码就相当于这里的，其实一样\r\n// type SaveMoviesAction = { \r\n//     type: \"movie_save\"\r\n//     payload: {\r\n//         movies: IMovie[]\r\n//         total: number\r\n//     }\r\n// }\r\n\r\n function saveMoviesAction(movies: IMovie[], total: number): SaveMoviesAction {\r\n    return {\r\n        type: \"movie_save\",\r\n        payload: {\r\n            movies,\r\n            total\r\n        }\r\n    }\r\n}\r\n\r\nexport type SetLoadingAction = IAction<\"movie_setLoading\", boolean>\r\n\r\nfunction setLoadingAction(isLoading: boolean): SetLoadingAction {\r\n    return {\r\n        type: \"movie_setLoading\",\r\n        payload: isLoading\r\n    }\r\n}\r\n\r\nexport type SetConditionAction = IAction<\"movie_setCondition\", ISearchCondition>\r\n\r\nfunction SetConditionAction(condition: ISearchCondition): SetConditionAction {\r\n    return {\r\n        type: \"movie_setCondition\",\r\n        payload: condition\r\n    }\r\n}\r\n\r\n//  从数据库中的删除\r\n// export type DeleteAction = IAction<\"movie_delete\", string>\r\n\r\n// function deleteAction(id: string): DeleteAction {\r\n//     return {\r\n//         type: \"movie_delete\",\r\n//         payload: id\r\n//     }\r\n// }\r\nexport type DeleteAction = IAction<\"movie_delete\", string>\r\n\r\nfunction deleteAction(id: string): DeleteAction {\r\n    return {\r\n        type: \"movie_delete\",\r\n        payload: id\r\n    }\r\n}\r\n\r\nexport type MovieActions = SaveMoviesAction | SetConditionAction | SetLoadingAction | DeleteAction | MovieChangeSwitchAction ;\r\n\r\n// 根据条件从服务器获取电影的数据\r\nfunction fetchMovies(condition: ISearchCondition): ThunkAction<Promise<void>, IRootState, any, MovieActions> {\r\n    return async (dispatch, getState) => {\r\n        // 1.设置加载状态\r\n        dispatch(setLoadingAction(true));\r\n        // 2.设置条件\r\n        dispatch(SetConditionAction(condition));\r\n        // 3.获取服务器数据\r\n        const curCondition = getState().movie.condition;\r\n        const resp = await MovieService.getMovies(curCondition);\r\n        // 4.更改仓库的数据\r\n        dispatch(saveMoviesAction(resp.data, resp.total));\r\n        // 关闭加载状态\r\n        dispatch(setLoadingAction(false));\r\n    }\r\n}\r\n\r\nfunction deleteMovie(id: string): ThunkAction<Promise<void>, IRootState, any, MovieActions> {\r\n    return async dispatch => {\r\n        dispatch(setLoadingAction(true));\r\n        await MovieService.delete(id);\r\n        // dispatch(deleteAction(id));//删除本地仓库中的数据\r\n         dispatch(deleteAction(id));//删除本地仓库中的数据\r\n        dispatch(setLoadingAction(false));\r\n    }\r\n}\r\n\r\nexport type MovieChangeSwitchAction = IAction<\"movie_switch\",{\r\n    type: SwitchType\r\n    newVal: boolean\r\n    id: string\r\n}>\r\n\r\nfunction changeSwitchAction(type: SwitchType, newVal: boolean, id: string): MovieChangeSwitchAction  {\r\n    return {\r\n        type: \"movie_switch\",\r\n        payload: {\r\n            type,\r\n            newVal,\r\n            id\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// 发送ajax请求\r\nfunction changeSwitch(type: SwitchType, newVal: boolean, id: string) \r\n    : ThunkAction<Promise<void>, IRootState, any, MovieActions> {\r\n        return async dispatch => {\r\n            dispatch(changeSwitchAction(type, newVal, id));\r\n            await MovieService.edit(id, {\r\n                // isHot: true\r\n                [type]:newVal\r\n            })\r\n        }\r\n    }\r\n\r\n\r\nexport default {\r\n    saveMoviesAction,\r\n    setLoadingAction,\r\n    SetConditionAction,\r\n    deleteAction,\r\n    fetchMovies,\r\n    deleteMovie,\r\n    changeSwitchAction,\r\n    changeSwitch \r\n}\r\n\r\n","import React, { Dispatch } from \"react\";\r\nimport MovieTable, { IMovieTableEvents } from \"../../components/MovieTable\";\r\nimport { connect } from \"react-redux\";\r\nimport { IRootState } from \"../../redux/reducers/RootReducer\";\r\nimport { IMovieState } from \"../../redux/reducers/MovieReducer\";\r\nimport MovieAction, { MovieActions } from \"../../redux/actions/MovieAction\";\r\n\r\nfunction mapStateToProps(state: IRootState): IMovieState {\r\n    return state.movie;\r\n}\r\n\r\n// 高阶组件\r\n// const HOC = connect(mapStateToProps)\r\n// const MovieContainer = HOC(MovieTable);\r\n// const MovieContainer = connect(mapStateToProps)(MovieTable)\r\n\r\n// export default class extends React.Component {\r\n//     render() {\r\n//         return (\r\n//             <h1>\r\n//                 <MovieContainer/>\r\n//             </h1>\r\n//         )\r\n//     }\r\n// }\r\n\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): IMovieTableEvents{\r\n    return {\r\n        onLoad() {\r\n            dispatch(MovieAction.fetchMovies({\r\n                page: 1,\r\n                limit: 10,\r\n                key:\"\"\r\n            }))\r\n        },\r\n        onSwitchChange(type, newState, id) {\r\n            // dispatch(MovieAction.changeSwitchAction(type, newState, id));\r\n            dispatch(MovieAction.changeSwitch(type, newState, id));\r\n        },\r\n        async onDelete(id) {\r\n            await dispatch(MovieAction.deleteMovie(id))\r\n        },\r\n        onChange(newPage) {\r\n            dispatch(MovieAction.fetchMovies({\r\n                page: newPage\r\n            }))\r\n        },\r\n        onKeyChange(key){\r\n            dispatch(MovieAction.SetConditionAction({\r\n                key\r\n            }))\r\n        },\r\n        onSearch(){\r\n            dispatch(MovieAction.fetchMovies({\r\n                page: 1\r\n            }))\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(MovieTable)","import React from \"react\";\r\nimport { Upload, Icon, message, Modal } from \"antd\";\r\nimport { UploadFile } from \"antd/lib/upload/interface\";\r\nimport { IResponseError, IResponseData } from \"../services/CommonTypes\";\r\n\r\ninterface IImgUploaderProps {\r\n    value?: string\r\n    onChange?: (imgUrl: string) => void\r\n}\r\n\r\ninterface IImgState {\r\n    showModal: boolean\r\n}\r\n\r\nexport default class extends React.Component<IImgUploaderProps> {\r\n\r\n    // 展示组件可以有状态，可以使用接口的方式进行约束\r\n    state: IImgState = {\r\n        showModal: false\r\n    }\r\n\r\n    private getUploadContent(){\r\n        if(this.props.value){\r\n            return null;\r\n        }\r\n        else{\r\n            return (\r\n                <div>\r\n                    <Icon type=\"plus\"/>\r\n                    <div>点击上传</div>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n\r\n    private getFileList(): UploadFile[] {\r\n        if(this.props.value) {\r\n            return [\r\n                {\r\n                    uid: this.props.value,\r\n                    name: this.props.value,\r\n                    url: this.props.value\r\n                }\r\n            ]\r\n        }\r\n        return []\r\n    }\r\n\r\n//   handleChange(info){\r\n//       console.log(info)\r\n//   }//这种方法不好，有坑，只能返回一个值\r\n\r\n// 下面这个方法可以，手动处理请求，拿数据\r\nasync handleRequest(p: any){\r\n    // console.log(p)\r\n    let formData = new FormData();\r\n    formData.append(p.filename, p.file);\r\n    // fetch api\r\n    const request = new Request(p.action, {\r\n        method: \"post\",\r\n        body: formData\r\n    });\r\n    const resp: IResponseData<string> | IResponseError = await fetch(request).then(resp => resp.json());\r\n    // console.log(resp);\r\n    if(resp.err) {\r\n        // 有错误\r\n        message.error(\"上传失败!\");\r\n    }\r\n    else{\r\n        // 触发回调\r\n        if(this.props.onChange){\r\n            this.props.onChange(resp.data!);\r\n        }    \r\n    }\r\n}\r\n\r\n    render(){\r\n        return (\r\n            // 文件名不匹配Unexpected field 修改name\r\n            // 文件类型\r\n        <div>\r\n            <Upload\r\n                action=\"/api/upload\"\r\n                name=\"imgfile\"\r\n                accept=\".jpg,.png,.gif\"\r\n                listType=\"picture-card\"\r\n                fileList={this.getFileList()}\r\n                // onChange={this.handleChange.bind(this)}\r\n                customRequest={this.handleRequest.bind(this)}\r\n                // 删除图片\r\n                onRemove={()=>{\r\n                    if(this.props.onChange){\r\n                        this.props.onChange(\"\")\r\n                    }                    \r\n                }}\r\n                // 预览\r\n              onPreview={()=>{\r\n                //   console.log(\"预览\")\r\n                this.setState({\r\n                    showModal: true\r\n                })\r\n              }}\r\n            >\r\n                {/* <div>\r\n                    <Icon type=\"plus\"/>\r\n                    <div>点击上传</div>\r\n                </div> */}\r\n                {this.getUploadContent()}\r\n            </Upload>\r\n            <Modal visible={this.state.showModal} footer={null} onCancel={()=>{\r\n                this.setState({\r\n                    showModal: false\r\n                })\r\n            }}>\r\n                <img src={this.props.value} alt=\"\" style={{width:'100%'}}/>\r\n            </Modal>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from \"react\";\r\nimport { Form, Input, Button, Checkbox, InputNumber, Switch, message } from \"antd\";\r\nimport { WrappedFormUtils } from \"antd/lib/form/Form\";\r\nimport { IMovie } from \"../services/MovieService\";\r\nimport ImgUploader from \"./ImgUploader\";\r\nimport { withRouter, RouteComponentProps } from \"react-router\";\r\n\r\ninterface IFormProp extends RouteComponentProps {\r\n    form: WrappedFormUtils<any>\r\n    onSubmit: (movie: IMovie) => Promise<string>\r\n    movie?: IMovie\r\n}\r\n\r\nconst formItemLayout = {\r\n    labelCol: {\r\n        span: 4\r\n    },\r\n    wrapperCol: {\r\n        span:19,\r\n        offset:1\r\n    },\r\n}\r\n\r\nconst AllAreas: { label: string, value: string }[] = [\r\n    { label: \"中国大陆\", value: \"中国大陆\"},\r\n    { label: \"美国\", value: \"美国\"},\r\n    { label: \"中国台湾\", value: \"中国台湾\"},\r\n    { label: \"英国\", value: \"英国\"}\r\n];\r\n\r\nconst AreaGroups = Checkbox.Group;\r\n\r\nconst AllTypes: { label: string, value: string }[] = [\r\n    { label: \"喜剧\", value: \"喜剧\"},\r\n    { label: \"灾难\", value: \"灾难\"},\r\n    { label: \"动作\", value: \"动作\"},\r\n    { label: \"言情\", value: \"言情\"}\r\n];\r\n\r\nconst TypeGroups= Checkbox.Group;\r\n\r\n class MovieForm extends React.Component<IFormProp> {\r\n\r\n    private handleSubmit(e: React.FormEvent<any>) {\r\n        e.preventDefault();\r\n        // console.log(\"表单提交了\")\r\n        // 获取表单数据\r\n\r\n        // 手动验证\r\n        this.props.form.validateFields(async errors => {\r\n            // console.log(errors);\r\n            if(!errors){\r\n                const formData = this.props.form.getFieldsValue();\r\n                // console.log(formData)\r\n                const result = await this.props.onSubmit(formData as IMovie) \r\n                    if(result){\r\n                        message.error(result)\r\n                    }\r\n                    else{\r\n                        message.success(\"处理成功\",1,()=>{\r\n                        // 跳转页面\r\n                        this.props.history.push(\"/movie\")\r\n                        })                    \r\n                    }\r\n            }\r\n        })  \r\n    }\r\n\r\n    render(){\r\n        // console.log(this.props.form);\r\n        const { getFieldDecorator } = this.props.form;\r\n        return (\r\n            // <h1>\r\n            //     电影表单\r\n            // </h1>\r\n          \r\n            <Form {...formItemLayout} style={{width:\"500px\"}} onSubmit={this.handleSubmit.bind(this)}>\r\n                <Form.Item label=\"电影名称\">\r\n                    {getFieldDecorator<IMovie>(\"name\", {\r\n                        rules: [{ required: true, message: '请填写电影名称'}]\r\n                    })(\r\n                        <Input/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"封面图\">\r\n                    {getFieldDecorator<IMovie>(\"poster\")(\r\n                        <ImgUploader/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"地区\">\r\n                    {getFieldDecorator<IMovie>(\"areas\", {\r\n                        rules: [{ required: true, message: '请填写地区'}]\r\n                    })(\r\n                        <AreaGroups options={AllAreas}></AreaGroups>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"类型\">\r\n                    {getFieldDecorator<IMovie>(\"types\", {\r\n                        rules: [{ required: true, message: '请填写类型'}]\r\n                    })(\r\n                        <TypeGroups options={AllTypes}></TypeGroups>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"时长(分钟)\">\r\n                    {getFieldDecorator<IMovie>(\"timeLong\", {\r\n                        rules: [{ required: true, message: '请填写时长'}]\r\n                    })(\r\n                        <InputNumber min={1} step={10}/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"正在热映\">\r\n                    {getFieldDecorator<IMovie>(\"isHot\",{\r\n                         initialValue: false,\r\n                         valuePropName:\"checked\"\r\n                    })(\r\n                        <Switch/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"即将上映\">\r\n                    {getFieldDecorator<IMovie>(\"isComing\",{\r\n                         initialValue: false,\r\n                         valuePropName:\"checked\"\r\n                    })(\r\n                        <Switch/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"经典影片\">\r\n                    {getFieldDecorator<IMovie>(\"isClassic\",{\r\n                        // 这个是处理switch开关的默认值，一开始在为改变之前是undefined，只有改变之后才会出现false或true，\r\n                        // 这里通过跳转到定义方法页面，找到相应文件，然后设置initialValue\r\n                         initialValue: false,\r\n                         valuePropName:\"checked\"\r\n                    })(\r\n                        <Switch/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item label=\"描述\">\r\n                    {getFieldDecorator<IMovie>(\"description\")(\r\n                        <Input.TextArea/>\r\n                    )}\r\n                </Form.Item>\r\n                <Form.Item labelCol={{ span: 0}}  wrapperCol={{ span: 19, offset: 5}}>\r\n                    <Button type=\"primary\" htmlType=\"submit\">提交</Button>\r\n                </Form.Item>\r\n            </Form>\r\n        );\r\n    }\r\n}\r\n\r\ntype MovieFields = {\r\n    [P in Exclude<keyof IMovie, \"_id\">]: any\r\n}\r\n\r\nfunction getDefaultField(movie: IMovie): MovieFields {\r\n    const obj: any = {};\r\n    for (const key in movie) {\r\n        obj[key] = Form.createFormField({\r\n            value: movie[key]\r\n        })\r\n    }\r\n    return obj;\r\n}\r\n\r\n// export default Form.create<IFormProp>()(withRouter(MovieForm));\r\nexport default withRouter(Form.create<IFormProp>({\r\n    mapPropsToFields: props => {\r\n        // if(props.movie) {\r\n            // return {\r\n            //     name: Form.createFormField({\r\n            //         value: props.movie.name\r\n            //     })\r\n            // }\r\n        // } \r\n        if(props.movie){\r\n            return getDefaultField(props.movie);\r\n        }  \r\n    }\r\n})(MovieForm));","import React from \"react\";\r\nimport MovieForm from \"../../components/MovieForm\";\r\nimport { MovieService } from \"../../services/MovieService\";\r\n\r\n\r\nexport default class extends React.Component {\r\n    render() {\r\n        return (\r\n            // <h1>\r\n            //     添加电影页\r\n            // </h1>\r\n            <MovieForm onSubmit={async movie=>{\r\n                const resp = await MovieService.add(movie)\r\n                if(resp.data){\r\n                    return \"\";\r\n                }\r\n                else{\r\n                    return resp.err;\r\n                }\r\n            }}></MovieForm>\r\n        )\r\n    }\r\n}","import React from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport MovieForm from \"../../components/MovieForm\";\r\nimport { MovieService, IMovie } from \"../../services/MovieService\";\r\n\r\ninterface IParams {\r\n    id: string\r\n}\r\n\r\ninterface EditPageState {\r\n    movie?: IMovie\r\n}\r\n\r\n\r\nexport default class extends React.Component<RouteComponentProps<IParams>, EditPageState> {\r\n    state: EditPageState = {\r\n        movie: undefined\r\n    }\r\n\r\n   async componentDidMount() {\r\n      const resp = await MovieService.getMovieById(this.props.match.params.id);\r\n      if(resp.data){\r\n          this.setState({\r\n              movie: resp.data\r\n          })\r\n      }\r\n   }\r\n\r\n    render() {\r\n        // console.log(this.props.match.params.id)//这里的属性是前面Route中的component注入的，可以通过泛型RouteComponentProps中获取,这里可以获取id\r\n        \r\n        \r\n        return (\r\n            // <h1>\r\n            //     修改电影页\r\n            //     { this.props.match.params.id}\r\n            // </h1>\r\n            <MovieForm \r\n            movie = {this.state.movie}\r\n            onSubmit={async movie=>{\r\n                const resp = await MovieService.edit(this.props.match.params.id, movie)\r\n                if(resp.data){\r\n                    return \"\";\r\n                }\r\n                else{\r\n                    return resp.err;\r\n                }\r\n            }}></MovieForm>\r\n        )\r\n    }\r\n}","import React from \"react\";\r\nimport { NavLink, Route } from \"react-router-dom\";\r\nimport Home from \"./Home\";\r\nimport MovieList from \"./movie/MovieList\";\r\nimport AddMovie from \"./movie/AddMovie\";\r\nimport EditMovie from \"./movie/EditMovie\";\r\nimport { Layout,Menu } from \"antd\";\r\n\r\n\r\nconst {\r\n    Header, Sider, Content,\r\n} = Layout;\r\nconst _Layout: React.FC = function () {\r\n    return (\r\n        // <div>\r\n        //     这是一个布局组件\r\n        // </div>\r\n        // <header>\r\n        //     {/* <ul> */}\r\n        //         <li>\r\n        //             <NavLink to=\"/\">首页</NavLink>\r\n        //         </li>\r\n        //         <li>\r\n        //             <NavLink to=\"/movie\">电影列表</NavLink>\r\n        //         </li>\r\n        //         <li>\r\n        //             <NavLink to=\"/movie/add\">添加电影</NavLink>\r\n        //         </li>\r\n        //         <li>\r\n        //             <NavLink to=\"/movie/edit/aaa\">修改电影</NavLink>\r\n        //         </li>\r\n        //     </ul>\r\n        <div className=\"container\">\r\n            <Layout>\r\n                <Header className=\"header\">\r\n                    <NavLink to=\"/\">猫眼电影管理系统</NavLink>\r\n                </Header>\r\n                <Layout>\r\n                    <Sider>\r\n                        <Menu\r\n                            mode=\"inline\"\r\n                            theme=\"dark\"\r\n                        >\r\n                            <Menu.Item key=\"1\">\r\n                                <NavLink to=\"/movie\">电影列表</NavLink>\r\n                            </Menu.Item>\r\n                            <Menu.Item key=\"2\">\r\n                               <NavLink to=\"/movie/add\">添加电影</NavLink>\r\n                            </Menu.Item>\r\n                        </Menu>\r\n                    </Sider>\r\n                    <Content>\r\n                        <div className=\"main\">\r\n                            <Route path=\"/\" component={Home} exact={true}></Route>\r\n                            <Route path=\"/movie\" component={MovieList} exact={true}></Route>\r\n                            <Route path=\"/movie/add\" component={AddMovie}></Route>\r\n                            <Route path=\"/movie/edit/:id\" component={EditMovie}></Route>\r\n                        </div>\r\n                    </Content>\r\n                </Layout>\r\n            </Layout>\r\n           \r\n        </div>\r\n           \r\n        // </header>\r\n    );\r\n}\r\n\r\nexport default _Layout;","import { ISearchCondition } from \"../../services/CommonTypes\";\r\nimport { IMovie } from \"../../services/MovieService\";\r\nimport { MovieActions, SaveMoviesAction, SetConditionAction, SetLoadingAction, DeleteAction, MovieChangeSwitchAction } from \"../actions/MovieAction\";\r\nimport { Reducer } from \"react\";\r\n\r\n// 描述电影列表的状态类型\r\n\r\nexport type IMovieCondition = Required<ISearchCondition>\r\n\r\n/**\r\n * 电影状态\r\n */\r\nexport interface IMovieState {\r\n    /**\r\n     * 电影数组\r\n     */\r\n    data: IMovie[]\r\n    /**\r\n     * 查询条件\r\n     */\r\n    condition: IMovieCondition\r\n    /**\r\n     * 总记录数\r\n     */\r\n    total: number\r\n    /**\r\n     * 是否正在加载数据\r\n     */\r\n    isLoading: boolean\r\n    /**\r\n     * 总页数\r\n     */\r\n    totalPage: number\r\n}\r\n\r\nconst defaultState: IMovieState = {\r\n    data: [],\r\n    condition: {\r\n        page: 1,\r\n        limit: 10,\r\n        key: \"\"\r\n    },\r\n    total: 0,\r\n    isLoading: false,\r\n    totalPage: 0\r\n}\r\n\r\ntype MovieReducer<A> = Reducer<IMovieState, A>\r\n\r\nconst saveMovie: MovieReducer<SaveMoviesAction> = function (state, action) {\r\n    return {\r\n        ...state,\r\n        data: action.payload.movies,\r\n        total: action.payload.total,\r\n        totalPage: Math.ceil(action.payload.total / state.condition.limit)\r\n    };\r\n}\r\n\r\nconst setCondition:MovieReducer<SetConditionAction>  = function (state, action) {\r\n    const newState = {\r\n        ...state,\r\n       condition: {\r\n           ...state.condition,\r\n           ...action.payload\r\n       }\r\n    };\r\n    newState.totalPage = Math.ceil(newState.total / newState.condition.limit);\r\n    return newState;\r\n}\r\n\r\nconst setLoading:MovieReducer<SetLoadingAction>  = function (state, action) {\r\n    return {\r\n        ...state,\r\n      isLoading: action.payload\r\n    };\r\n}\r\n\r\nconst deleteMovie:MovieReducer<DeleteAction>  = function (state, action) {\r\n    return {\r\n        ...state,\r\n       data: state.data.filter(m => m._id !== action.payload),\r\n       total: state.total - 1,\r\n       totalPage:Math.ceil((state.total -1) / state.condition.limit)\r\n    };\r\n}\r\n\r\n\r\nconst changeSwitch: MovieReducer<MovieChangeSwitchAction> = function (state, action) {\r\n//    action.payload\r\n// 1.根据id找到对象\r\n    const movie = state.data.find(d=>d._id === action.payload.id);\r\n    if(!movie){\r\n        return state;\r\n    }\r\n    // 2.对象克隆\r\n    const newMovie = { ...movie };\r\n    newMovie[action.payload.type] = action.payload.newVal;\r\n\r\n    // 3.将对象重新放入到数组\r\n   const newData = state.data.map(d=>{// 映射的方式\r\n        if(d._id === action.payload.id){\r\n            return newMovie;\r\n        }\r\n        return d;\r\n    })\r\n\r\n    return {\r\n        ...state,\r\n        data:newData\r\n    }\r\n}\r\n\r\nexport default function (state: IMovieState = defaultState, action: MovieActions){\r\n        //可辨识的联合\r\n    switch (action.type) {\r\n        case \"movie_delete\":\r\n           return deleteMovie(state, action);\r\n        case \"movie_save\":\r\n           return saveMovie(state, action);\r\n        case \"movie_setCondition\":\r\n            return setCondition(state, action);\r\n        case \"movie_setLoading\":\r\n            return setLoading(state, action);\r\n        case \"movie_switch\":\r\n            return changeSwitch(state, action);\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n","import { combineReducers } from \"redux\";\r\nimport movie, { IMovieState } from \"./MovieReducer\";\r\n\r\n/**\r\n * 整个网站的根状态\r\n */\r\nexport interface IRootState {\r\n    movie: IMovieState\r\n}\r\n\r\nexport const rootReducer = combineReducers({\r\n    movie\r\n})\r\n\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport { rootReducer, IRootState } from \"./reducers/RootReducer\";\r\nimport logger from \"redux-logger\";\r\nimport thunk, { ThunkMiddleware } from \"redux-thunk\";\r\n\r\nexport const store = createStore(\r\n    rootReducer,\r\n    applyMiddleware(thunk as ThunkMiddleware<IRootState>, logger)\r\n);\r\n\r\n","import React from 'react';\nimport Layout from \"./pages/Layout\";\nimport { BrowserRouter, Route } from \"react-router-dom\";\nimport { Provider } from \"react-redux\";\nimport { store } from \"./redux/store\";\n\nconst App: React.FC = () => {\n  return (\n    <Provider store={store}>\n      <BrowserRouter>\n        <Route path=\"/\" component={Layout}></Route>\n      </BrowserRouter>\n    </Provider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import { store } from './redux/store';\n// import MovieAction from './redux/actions/MovieAction';\n// import * as serviceWorker from './serviceWorker';\n// import { MovieService } from './services/MovieService';\n\nimport \"antd/dist/antd.css\"\n\n// store.subscribe(()=> {\n//     console.log(store.getState());\n// })\n\n// store.dispatch(MovieAction.setLoadingAction(true));\n\n// store.dispatch(MovieAction.SetConditionAction({\n//     page:2\n// }))\n\n// store.dispatch(MovieAction.fetchMovies({\n//     page: 2\n// })).then(()=>{\n//     store.dispatch(MovieAction.deleteMovie(\"5e114d2a78be4d31e83dcfb3\"));\n// })\n\n\n//路由\n\n\n//界面  antd: UI库\n\n\n\n\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\n// MovieService.add({\n//     name: \"abc\",\n//     timeLong: 33,\n//     types: [\"喜剧\"],\n//     areas: [\"大陆\"],\n//     isHot: true,\n//     isClassic: false,\n//     isComing: true\n// }).then(data => {\n    \n// })\n\n// MovieService.getMovies({\n//     page:2\n// }).then(movies => {\n//     movies.data.forEach(m => {\n//         console.log(m.name, m.types)\n//     })\n// })"],"sourceRoot":""}